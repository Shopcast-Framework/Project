<head></head>
<body>
    <div>
        <button id="facebookBtn">Connect Facebook</button>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <script>
    window.fbAsyncInit = function() {

        document.getElementById('facebookBtn').onclick = function() {
            FB.login(function(response) {
                var datas = response.authResponse;
                datas['access_token'] = datas['accessToken']
                datas['strategy'] = 'facebook';
                datas['status'] = response.status;
                $.ajax({
                    url: "http://localhost:3000/api/session",
                    method: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(datas),
                    success: function(data) {
                        console.log('then');
                        console.log(data);
                    },
                    error: function(err) {
                        console.log('error:');
                        console.log(err);
                    }
                });
                console.log(response);
            });
        };

        console.log("Init")
        FB.init({
            appId      : '751447004955328',
            xfbml      : true,
            version    : 'v2.5'
        });
    };

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "http://connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
    </script>
</body>
