<link href="../bower_components/video.js/dist/video-js.min.css" rel="stylesheet">
<link href="../css/style.css" rel="stylesheet">
<script src="../bower_components/video.js/dist/video.min.js"></script>
<script src="../bower_components/videojs-playlist/dist/videojs-playlist.js"></script>
<script>
  videojs.options.flash.swf = "../bower_components/video.js/dist/video-js.swf"
</script>
<video id="shopcast_player" class="video-js vjs-default-skin"
                            width="640" height="264">
  
     
  <p class="vjs-no-js">To view this video please enable JavaScript, and consider upgrading to a web browser that <a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a></p>
</video>

<script>
    const remote = require('electron').remote;
    var playerPlaylist = remote.getGlobal('playlist').toPlay;
    var playerUntil = remote.getGlobal('playlist').until;

    var player_lib = require('../src/player.js');

    var playerOptions = {
        "controls" : true,
        "autoplay" : true,
        "preload"  : true,
    }
    
    var a = new Date();
    var b = playerUntil;
    console.log(playerPlaylist[0].duration);

    playerPlaylist = player_lib.createPlaylistTimetable(a, b, playerPlaylist);

    var player = videojs("shopcast_player", playerOptions, function(){
        var cnt = 0; 
        // Player (this) is initialized and ready.

        console.log('Good to go !');
        player_lib.playerAction(this, playerPlaylist, cnt);


        this.on('ended', function() {
            cnt = cnt + 1;
            if (cnt >= playerPlaylist.length) {
              console.log('safety bit');
              cnt = 0;
              /// Will need to stop start the new playlist calculation
              /// currently simple repeat
              /// also, a stack system would be smarter but wutevr
            }
            cnt += player_lib.playerAction(this, playerPlaylist, cnt);
        });
    });
</script>

<p><a href="./index.html">Back</a></p>
